<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–°–≤–æ—è –∏–≥—Ä–∞ ‚Äî –ö—É–ª—å—Ç—É—Ä–∞ –∏ —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–∏</title>
  <style>
    /* –í—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–∞–∫–∏–º–∏ –∂–µ */
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&display=swap');
    :root {
      --primary-glow: #ffd700;
      --secondary-glow: #4a9eff;
      --bg-dark: #000041ff;
      --bg-mid: #000c8cff;
      --bg-light: #02046eff;
      --text-light: #fff;
      --text-dim: #b0d4ff;
    }
    * { box-sizing: border-box; }
    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, var(--bg-light) 0%, var(--bg-mid) 50%, var(--bg-dark) 100%);
      color: var(--text-light);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      overflow-x: hidden;
      position: relative;
      padding: 20px;
    }
    .bg-animation { position: absolute; inset: 0; overflow: hidden; z-index: 0; opacity: 0.25; }
    .bg-symbol {
      position: absolute;
      font-size: 2rem;
      color: var(--primary-glow);
      font-weight: 300;
      animation: floatSymbol 15s infinite linear;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
      user-select: none;
    }
    @keyframes floatSymbol {
      0% { transform: translateY(110vh) rotate(0deg); opacity: 0; }
      5% { opacity: 0; }
      15% { opacity: 1; }
      85% { opacity: 1; }
      95% { opacity: 0; }
      100% { transform: translateY(-20vh) rotate(360deg); opacity: 0; }
    }
    .screen {
      text-align: center;
      z-index: 10;
      position: relative;
      animation: fadeIn 0.8s ease;
      max-width: 1200px;
      width: 100%;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .logo-container { margin-bottom: 2em; }
    .title {
      font-size: 3.5rem;
      font-weight: 700;
      color: var(--primary-glow);
      margin: 0;
      letter-spacing: 12px;
      text-transform: uppercase;
      text-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
    }
    .subtitle {
      font-size: 1.1rem;
      color: #e4e000ff;
      margin-top: 1em;
      font-weight: 300;
      letter-spacing: 2px;
    }
    .settings-btn {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(74, 158, 255, 0.2);
      border: 1px solid rgba(74, 158, 255, 0.4);
      color: var(--primary-glow);
      padding: 0.8em 1.5em;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
      z-index: 20;
    }
    .settings-btn:hover {
      background: rgba(74, 158, 255, 0.3);
      transform: translateY(-2px);
    }
    .teams {
      margin: 2em 0;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2em;
      max-width: 700px;
      margin-left: auto;
      margin-right: auto;
    }
    .team-box {
      background: rgba(74, 158, 255, 0.08);
      border: 1px solid rgba(74, 158, 255, 0.3);
      border-radius: 8px;
      padding: 2em 1.5em;
      transition: all 0.3s ease;
    }
    .team-box:hover {
      background: rgba(74, 158, 255, 0.12);
      border-color: rgba(74, 158, 255, 0.5);
      transform: translateY(-3px);
    }
    .team-label {
      font-size: 0.9rem;
      color: var(--primary-glow);
      margin-bottom: 1em;
      font-weight: 400;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    input, select {
      padding: 0.9em 1.2em;
      border-radius: 6px;
      border: 1px solid rgba(74, 158, 255, 0.4);
      outline: none;
      background: rgba(10, 37, 64, 0.6);
      color: var(--text-light);
      font-size: 1rem;
      width: 100%;
      text-align: center;
      transition: all 0.3s ease;
      font-weight: 300;
    }
    input::placeholder { color: rgba(255, 255, 255, 0.4); }
    input:focus, select:focus {
      border-color: var(--secondary-glow);
      background: rgba(10, 37, 64, 0.8);
      box-shadow: 0 0 0 3px rgba(74, 158, 255, 0.1);
    }
    input:disabled { opacity: 0.5; cursor: not-allowed; }
    .buttons { margin-top: 2em; }
    .big-btn {
      background: var(--secondary-glow);
      color: var(--text-light);
      border: none;
      padding: 1em 3em;
      font-size: 1.1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 0.5em;
      font-weight: 400;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 4px 15px rgba(74, 158, 255, 0.3);
    }
    .big-btn:hover {
      background: #3a8eef;
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(74, 158, 255, 0.4);
    }
    .hint {
      font-size: 0.95rem;
      color: var(--text-dim);
      margin-top: 2em;
      font-weight: 300;
    }
    .hidden { display: none !important; }
    .modal {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.85);
      display: flex;
      justify-content: center;
      align-items: center;
      transition: opacity 0.3s ease;
      z-index: 100;
      backdrop-filter: blur(8px);
    }
    .modal.hidden { opacity: 0; pointer-events: none; }
    .modal-content {
      background: linear-gradient(135deg, #01047e 0%, #020a5f 100%);
      border: 1px solid rgba(255, 215, 0, 0.4);
      border-radius: 12px;
      padding: 2em 3em;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
      animation: modalAppear 0.4s ease;
      min-width: 400px;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
    }
    @keyframes modalAppear {
      from { transform: scale(0.9); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .modal-content h2 {
      font-size: 1.8rem;
      color: var(--primary-glow);
      margin-bottom: 1em;
      font-weight: 400;
      letter-spacing: 2px;
    }
    .settings-group { margin: 1.5em 0; text-align: left; }
    .settings-group label { display: block; color: var(--text-dim); margin-bottom: 0.5em; font-size: 0.9rem; }
    .coin {
      width: 140px;
      height: 140px;
      position: relative;
      margin: 2em auto;
      transform-style: preserve-3d;
      transition: transform 2.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    .face {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 400;
      font-size: 1.2rem;
      backface-visibility: hidden;
      background-size: cover;
      background-position: center;
      box-shadow: 0 8px 30px rgba(74, 158, 255, 0.4);
      border: 3px solid rgba(255, 215, 0, 0.4);
      color: var(--text-light);
    }
    .heads { background-image: url('https://media.discordapp.net/attachments/1344289233447419926/1427219340033265794/coin_heads.png?ex=68ee1117&is=68ecbf97&hm=8ba24400fb08c9927b09987c0daafa199b727f2e357cdd30196ca0067460c9c9&=&format=webp&quality=lossless&width=640&height=640'); }
    .tails { transform: rotateY(180deg); background-image: url('https://media.discordapp.net/attachments/1344289233447419926/1427219340574461993/coin_tails.png?ex=68ee1117&is=68ecbf97&hm=08414785dee1287ab484dd629ea1f50e1858f0fb2f212a1c9f175a67f4ab5244&=&format=webp&quality=lossless&width=640&height=640'); }
    .result {
      font-size: 1.4rem;
      color: var(--primary-glow);
      margin-top: 1.5em;
      font-weight: 400;
      animation: resultAppear 0.4s ease;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }
    @keyframes resultAppear {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .small-btn {
      background: transparent;
      color: var(--secondary-glow);
      border: 1px solid var(--secondary-glow);
      padding: 0.8em 2.5em;
      font-size: 1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 400;
      text-transform: uppercase;
      margin: 0.5em;
      letter-spacing: 1px;
    }
    .small-btn:hover { background: var(--secondary-glow); color: var(--text-light); transform: translateY(-2px); }
    header {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary-glow);
      letter-spacing: 8px;
      text-transform: uppercase;
      text-shadow: 0 2px 10px rgba(255, 215, 0, 0.3);
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5em;
      flex-wrap: wrap;
      gap: 1em;
    }
    header h1 { flex: 1; text-align: center; margin: 0; font-size: 2.8rem; min-width: 200px; }
    #turn-indicator {
      color: var(--primary-glow);
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 20px;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.4);
    }
    .team {
      font-size: 1.1rem;
      text-align: center;
      color: var(--text-light);
      background: rgba(74, 158, 255, 0.1);
      padding: 10px 20px;
      border-radius: 8px;
      border: 1px solid rgba(74, 158, 255, 0.3);
      box-shadow: 0 0 10px rgba(74, 158, 255, 0.2);
      min-width: 180px;
    }
    .team-name { color: var(--primary-glow); font-weight: 600; margin-bottom: 4px; }
    .team-score-wrapper { display: flex; align-items: center; justify-content: center; gap: 10px; }
    .team-score { font-size: 1.3rem; font-weight: 700; }
    .score-btn {
      background: rgba(74, 158, 255, 0.3);
      border: 1px solid rgba(74, 158, 255, 0.5);
      color: var(--text-light);
      width: 24px;
      height: 24px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1rem;
      line-height: 22px;
      transition: all 0.2s ease;
      padding: 0;
    }
    .score-btn:hover { background: var(--secondary-glow); transform: scale(1.1); }
    .team-lifelines { font-size: 0.85rem; color: var(--text-dim); margin-top: 5px; }
    #board { display: flex; flex-direction: column; gap: 12px; z-index: 10; margin-bottom: 2em; }
    .category-title {
      background: rgba(74, 158, 255, 0.08);
      border: 1px solid rgba(74, 158, 255, 0.3);
      border-radius: 8px;
      padding: 8px;
      font-size: 0.95rem;
      color: var(--primary-glow);
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      font-weight: 500;
      line-height: 1.2;
    }
    .value-btn {
      background: rgba(10, 37, 64, 0.6);
      border: 1px solid rgba(74, 158, 255, 0.4);
      color: var(--text-light);
      font-size: 1.1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      padding: 0.8em;
      font-weight: 400;
    }
    .value-btn:hover {
      background: var(--secondary-glow);
      border-color: var(--secondary-glow);
      transform: translateY(-3px);
      box-shadow: 0 0 10px rgba(74, 158, 255, 0.4);
    }
    .value-btn.used {
      background: rgba(255, 255, 255, 0.1);
      color: #777;
      pointer-events: none;
      box-shadow: none;
      transform: none;
    }
    #question-box {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.85);
      justify-content: center;
      align-items: center;
      flex-direction: column;
      text-align: center;
      z-index: 100;
      backdrop-filter: blur(8px);
      padding: 20px;
    }
    #timer-display {
      position: absolute;
      top: 30px;
      font-size: 3rem;
      color: var(--primary-glow);
      font-weight: 700;
      text-shadow: 0 0 15px rgba(255,215,0,0.5);
    }
    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    #timer-display.low-time { color: #ff4d4d; animation: pulse 1s infinite; }
    #media-container {
      max-width: 90%;
      margin: 0 auto 15px;
    }
    #media-container img {
      max-width: 100%;
      max-height: 30vh;
      border-radius: 8px;
      border: 2px solid var(--primary-glow);
    }
     #media-container audio {
      width: 100%;
      max-width: 400px;
      margin-top: 10px;
    }
    #question {
      font-size: 1.8rem;
      margin-top: 10px;
      margin-bottom: 20px;
      color: var(--primary-glow);
      max-width: 800px;
      padding: 0 20px;
    }
    .options {
      display: grid;
      grid-template-columns: repeat(2,1fr);
      gap: 15px;
      width: 80%;
      max-width: 700px;
      margin: 0 auto 20px auto;
    }
    .option-btn {
      background: rgba(10,37,64,0.6);
      border: 1px solid rgba(74,158,255,0.4);
      color: var(--text-light);
      border-radius: 6px;
      padding: 1em;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
    }
    .option-btn:hover { background: var(--secondary-glow); transform: translateY(-2px); }
    .option-btn.fifty-fifty-hidden { visibility: hidden; pointer-events: none; opacity: 0.3; }
    #score { margin-top: 1em; color: var(--primary-glow); font-size: 1.2rem; }
    #final-result {
      display: none;
      position: fixed;
      inset: 0;
      z-index: 200;
      background: rgba(0,0,0,0.9);
      color: var(--primary-glow);
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-size: 2rem;
      text-shadow: 0 0 15px rgba(255,215,0,0.6);
    }
    .game-controls { margin-top: 1em; display: flex; gap: 1em; justify-content: center; flex-wrap: wrap; }
    .control-btn {
      background: rgba(74, 158, 255, 0.2);
      border: 1px solid rgba(74, 158, 255, 0.4);
      color: var(--primary-glow);
      padding: 0.6em 1.2em;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.9rem;
    }
    .control-btn:hover { background: rgba(74, 158, 255, 0.3); transform: translateY(-2px); }
    .control-btn:disabled { opacity: 0.5; cursor: not-allowed; transform: none; }
    .confetti-piece {
      position: fixed;
      width: 10px;
      height: 20px;
      z-index: 9999;
      top: -20px;
      opacity: 0;
      animation: confetti-fall 5s linear forwards;
    }
    @keyframes confetti-fall {
        0% { transform: translateY(0vh) rotate(0deg); opacity: 1; }
        100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="bg-animation" id="bgAnimation"></div>
  <div id="start-screen" class="screen">
    <button class="settings-btn" onclick="showSettings()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
    <div class="logo-container">
      <h1 class="title">–°–í–û–Ø –ò–ì–†–ê</h1>
      <p class="subtitle">–ö—É–ª—å—Ç—É—Ä–∞ –∏ —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–∏</p>
    </div>
    <div class="teams">
      <div class="team-box">
        <div class="team-label">–ö–æ–º–∞–Ω–¥–∞ 1</div>
        <input id="teamA" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã" />
      </div>
      <div class="team-box">
        <div class="team-label">–ö–æ–º–∞–Ω–¥–∞ 2</div>
        <input id="teamB" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã" />
      </div>
    </div>
    <div class="buttons">
      <button id="confirmBtn" class="big-btn">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å</button>
      <button id="playBtn" class="big-btn hidden">–ë—Ä–æ—Å–∏—Ç—å –∂—Ä–µ–±–∏–π</button>
    </div>
    <p class="hint">–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥ –¥–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã</p>
  </div>
  <div id="game-screen" class="screen hidden">
    <header>
      <div class="team" id="team1">
        <div class="team-name" id="team1-name"></div>
        <div class="team-score-wrapper">
            <button class="score-btn" onclick="adjustScore('team1', -100)">-</button>
            <div class="team-score" id="team1-score">0</div>
            <button class="score-btn" onclick="adjustScore('team1', 100)">+</button>
        </div>
        <div class="team-lifelines">50/50: <span id="team1-lifelines">3</span></div>
      </div>
      <h1>–°–í–û–Ø –ò–ì–†–ê</h1>
      <div class="team" id="team2">
        <div class="team-name" id="team2-name"></div>
        <div class="team-score-wrapper">
            <button class="score-btn" onclick="adjustScore('team2', -100)">-</button>
            <div class="team-score" id="team2-score">0</div>
            <button class="score-btn" onclick="adjustScore('team2', 100)">+</button>
        </div>
        <div class="team-lifelines">50/50: <span id="team2-lifelines">3</span></div>
      </div>
    </header>
    <div id="turn-indicator"></div>
    <div id="board"></div>
    <div class="game-controls">
      <button class="control-btn" onclick="showSettings()">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
      <button class="control-btn" onclick="resetGame()">üîÑ –ù–æ–≤–∞—è –∏–≥—Ä–∞</button>
    </div>
  </div>
  <div class="modal hidden" id="settingsModal">
    <div class="modal-content">
      <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã</h2>
      <div class="settings-group">
        <label>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥—Å–∫–∞–∑–æ–∫ 50/50 –Ω–∞ –∫–æ–º–∞–Ω–¥—É:</label>
        <select id="lifelines-count">
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="3" selected>3</option>
          <option value="5">5</option>
          <option value="unlimited">–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ</option>
        </select>
      </div>
      <div class="settings-group">
        <label>–í—Ä–µ–º—è –Ω–∞ –æ—Ç–≤–µ—Ç (—Å–µ–∫—É–Ω–¥):</label>
        <select id="answer-time">
          <option value="15">15</option>
          <option value="30" selected>30</option>
          <option value="45">45</option>
          <option value="60">60</option>
          <option value="unlimited">–ë–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π</option>
        </select>
      </div>
      <div class="settings-group">
        <label>–®—Ç—Ä–∞—Ñ –∑–∞ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:</label>
        <select id="penalty-mode">
          <option value="none" selected>–ë–µ–∑ —à—Ç—Ä–∞—Ñ–∞</option>
          <option value="half">–ü–æ–ª–æ–≤–∏–Ω–∞ —Å—Ç–æ–∏–º–æ—Å—Ç–∏</option>
          <option value="full">–ü–æ–ª–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</option>
        </select>
      </div>
      <button class="small-btn" onclick="saveSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
      <button class="small-btn" onclick="closeSettings()">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>
  <div class="modal hidden" id="coinModal">
    <div class="modal-content">
      <h2>–û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–µ—Ä–≤—ã–π —Ö–æ–¥</h2>
      <div class="coin" id="coin">
        <div class="face heads"></div>
        <div class="face tails"></div>
      </div>
      <div class="result" id="coinResult"></div>
      <button id="coinOk" class="small-btn hidden">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    </div>
  </div>
  <div id="question-box">
    <div id="timer-display"></div>
    <div id="media-container"></div>
    <div id="question"></div>
    <div class="options" id="options"></div>
    <button id="fifty-fifty-btn" class="small-btn">50/50</button>
    <div id="score"></div>
  </div>
  <div id="final-result"></div>

  <script>
    // –í–µ—Å—å JavaScript –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–∞–∫–∏–º –∂–µ, –∫–∞–∫ –≤ –∫–æ–¥–µ –≤—ã—à–µ
    const audioContext = new (window.AudioContext || window.webkitAudioContext)();
    function playSound(frequency, duration, type = 'sine') {
      try {
        const oscillator = audioContext.createOscillator();
        const gainNode = audioContext.createGain();
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        oscillator.frequency.value = frequency;
        oscillator.type = type;
        gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + duration);
        oscillator.start(audioContext.currentTime);
        oscillator.stop(audioContext.currentTime + duration);
      } catch(e) { console.warn("Web Audio API not supported."); }
    }
    const playClick = () => playSound(600, 0.08, 'triangle');
    const playSuccess = () => { playSound(523, 0.1); setTimeout(() => playSound(783, 0.15), 120); };
    const playError = () => playSound(200, 0.2, 'square');
    const bgAnimation = document.getElementById('bgAnimation');
    const culturalSymbols = ['üèõÔ∏è','üìú','üè∫','üé≠','üóø','‚ò•','‚òØÔ∏è','‚öúÔ∏è','‚ú°Ô∏è','‚ò™Ô∏è','üïâÔ∏è','‚òÆÔ∏è','‚úíÔ∏è','üé®','üéº'];
    for (let i = 0; i < 25; i++) {
      const symbol = document.createElement('div');
      symbol.className = 'bg-symbol';
      symbol.textContent = culturalSymbols[Math.floor(Math.random() * culturalSymbols.length)];
      symbol.style.left = (Math.random() * 95) + '%';
      symbol.style.animationDuration = (Math.random() * 10 + 10) + 's';
      symbol.style.fontSize = (Math.random() * 1.8 + 0.9) + 'rem';
      symbol.style.animationDelay = -(Math.random() * 15) + 's';
      bgAnimation.appendChild(symbol);
    }
    function shuffleArray(array) {
      const newArray = [...array];
      for (let i = newArray.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
      }
      return newArray;
    }
    function triggerConfetti() {
        const colors = ['#ffd700', '#4a9eff', '#ff4d4d', '#4dd0e1', '#f48fb1'];
        for (let i = 0; i < 150; i++) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti-piece';
            confetti.style.left = Math.random() * 100 + 'vw';
            confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
            confetti.style.animationDuration = (Math.random() * 3 + 4) + 's';
            confetti.style.animationDelay = Math.random() * 3 + 's';
            confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
            document.body.appendChild(confetti);
            confetti.addEventListener('animationend', () => {
                confetti.remove();
            });
        }
    }
    const categories = [
      {
        id: "–ê–Ω—Ç–∏—á–Ω–æ—Å—Ç—å",
        questions: [
          { value: 200, question: "–ö–∞–∫–∞—è —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏—è –ø–æ—Å—Ç—Ä–æ–∏–ª–∞ –ü–∞—Ä—Ñ–µ–Ω–æ–Ω –≤ –ê—Ñ–∏–Ω–∞—Ö?", correct: "–î—Ä–µ–≤–Ω—è—è –ì—Ä–µ—Ü–∏—è", options: ["–î—Ä–µ–≤–Ω–∏–π –†–∏–º", "–î—Ä–µ–≤–Ω—è—è –ì—Ä–µ—Ü–∏—è", "–î—Ä–µ–≤–Ω–∏–π –ï–≥–∏–ø–µ—Ç", "–ú–µ—Å–æ–ø–æ—Ç–∞–º–∏—è"] },
          { value: 400, question: "–ö—Ç–æ –±—ã–ª –±–æ–≥–æ–º –≥—Ä–æ–º–∞ –∏ –º–æ–ª–Ω–∏–π –≤ –¥—Ä–µ–≤–Ω–µ–≥—Ä–µ—á–µ—Å–∫–æ–π –º–∏—Ñ–æ–ª–æ–≥–∏–∏?", correct: "–ó–µ–≤—Å", options: ["–ê–ø–æ–ª–ª–æ–Ω", "–ê—Ä–µ—Å", "–ó–µ–≤—Å", "–ü–æ—Å–µ–π–¥–æ–Ω"] },
          { value: 600, question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–ª–∞—Å—å –≥–ª–∞–≤–Ω–∞—è —Ç–æ—Ä–≥–æ–≤–∞—è –∏ –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–ª–æ—â–∞–¥—å –≤ –î—Ä–µ–≤–Ω–∏—Ö –ê—Ñ–∏–Ω–∞—Ö?", correct: "–ê–≥–æ—Ä–∞", options: ["–§–æ—Ä—É–º", "–ê–≥–æ—Ä–∞", "–ê–∫—Ä–æ–ø–æ–ª—å", "–ö–æ–ª–∏–∑–µ–π"] },
          { value: 800, question: "–ö–∞–∫–æ–π —Ñ–∏–ª–æ—Å–æ—Ñ, –∞–≤—Ç–æ—Ä —Ç—Ä—É–¥–∞ '–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–æ', –±—ã–ª —É—á–µ–Ω–∏–∫–æ–º –°–æ–∫—Ä–∞—Ç–∞?", correct: "–ü–ª–∞—Ç–æ–Ω", options: ["–ê—Ä–∏—Å—Ç–æ—Ç–µ–ª—å", "–ü–ª–∞—Ç–æ–Ω", "–°–æ–∫—Ä–∞—Ç", "–ì–µ—Ä–æ–¥–æ—Ç"] },
          { value: 1000, question: "–ö–∞–∫ –∑–≤–∞–ª–∏ —Ñ–∏–ª–æ—Å–æ—Ñ–∞-–∫–∏–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π, –ø–æ –ª–µ–≥–µ–Ω–¥–µ, –∂–∏–ª –≤ –±–æ—á–∫–µ?", correct: "–î–∏–æ–≥–µ–Ω", options: ["–ü–∏—Ñ–∞–≥–æ—Ä", "–î–∏–æ–≥–µ–Ω", "–≠–ø–∏–∫—É—Ä", "–ó–µ–Ω–æ–Ω"] }
        ]
      },
      {
        id: "–î—Ä–µ–≤–Ω–∏–π –í–æ—Å—Ç–æ–∫",
        questions: [
          { value: 200, question: "–ö–∞–∫–∞—è —Ä–µ–∫–∞ –±—ã–ª–∞ –æ—Å–Ω–æ–≤–æ–π –∂–∏–∑–Ω–∏ –∏ –ø—Ä–æ—Ü–≤–µ—Ç–∞–Ω–∏—è –î—Ä–µ–≤–Ω–µ–≥–æ –ï–≥–∏–ø—Ç–∞?", correct: "–ù–∏–ª", options: ["–¢–∏–≥—Ä", "–ï–≤—Ñ—Ä–∞—Ç", "–ù–∏–ª", "–ò–Ω–¥"] },
          { value: 400, question: "–í –∫–∞–∫–æ–π –¥—Ä–µ–≤–Ω–µ–π —Å—Ç—Ä–∞–Ω–µ, —Å–æ–≥–ª–∞—Å–Ω–æ –ª–µ–≥–µ–Ω–¥–µ, –Ω–∞—Ö–æ–¥–∏–ª–∏—Å—å –≤–∏—Å—è—á–∏–µ —Å–∞–¥—ã –°–µ–º–∏—Ä–∞–º–∏–¥—ã?", correct: "–í–∞–≤–∏–ª–æ–Ω", options: ["–ï–≥–∏–ø–µ—Ç", "–ê—Å—Å–∏—Ä–∏—è", "–í–∞–≤–∏–ª–æ–Ω", "–ü–µ—Ä—Å–∏—è"] },
          { value: 600, question: "–ö–∞–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–∏—Å—å–º–∞, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –≤—ã–¥–∞–≤–ª–∏–≤–∞–Ω–∏–∏ –∑–Ω–∞–∫–æ–≤ –Ω–∞ –≥–ª–∏–Ω–µ, —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∞ –≤ –®—É–º–µ—Ä–µ?", correct: "–ö–ª–∏–Ω–æ–ø–∏—Å—å", options: ["–ò–µ—Ä–æ–≥–ª–∏—Ñ—ã", "–ö–ª–∏–Ω–æ–ø–∏—Å—å", "–ê–ª—Ñ–∞–≤–∏—Ç", "–ü–∏–∫—Ç–æ–≥—Ä–∞—Ñ–∏—è"] },
          { value: 800, question: "–ö—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –æ—Å–Ω–æ–≤–∞—Ç–µ–ª–µ–º –ø–µ—Ä–≤–æ–π –≤ –º–∏—Ä–µ –∏–º–ø–µ—Ä–∏–∏ ‚Äî –ê–∫–∫–∞–¥—Å–∫–æ–π?", correct: "–°–∞—Ä–≥–æ–Ω –î—Ä–µ–≤–Ω–∏–π", options: ["–•–∞–º–º—É—Ä–∞–ø–∏", "–°–∞—Ä–≥–æ–Ω –î—Ä–µ–≤–Ω–∏–π", "–ù–∞–≤—É—Ö–æ–¥–æ–Ω–æ—Å–æ—Ä II", "–ê—à—à—É—Ä–±–∞–Ω–∞–ø–∞–ª"] },
          { value: 1000, question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–≤—è—â–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –∑–æ—Ä–æ–∞—Å—Ç—Ä–∏–∑–º–∞, –¥—Ä–µ–≤–Ω–µ–π —Ä–µ–ª–∏–≥–∏–∏ –ü–µ—Ä—Å–∏–∏?", correct: "–ê–≤–µ—Å—Ç–∞", options: ["–¢–∞–ª–º—É–¥", "–ê–≤–µ—Å—Ç–∞", "–í–µ–¥—ã", "–¢–∏–ø–∏—Ç–∞–∫–∞"] }
        ]
      },
      {
        id: "–°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤—å–µ",
        questions: [
          { value: 200, question: "–ö–∞–∫–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π —Å—Ç–∏–ª—å, —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É—é—â–∏–π—Å—è –º–∞—Å—Å–∏–≤–Ω—ã–º–∏ —Å—Ç–µ–Ω–∞–º–∏ –∏ –ø–æ–ª—É–∫—Ä—É–≥–ª—ã–º–∏ –∞—Ä–∫–∞–º–∏, –¥–æ–º–∏–Ω–∏—Ä–æ–≤–∞–ª –≤ –ï–≤—Ä–æ–ø–µ –≤ X-XII –≤–µ–∫–∞—Ö?", correct: "–†–æ–º–∞–Ω—Å–∫–∏–π —Å—Ç–∏–ª—å", options: ["–ì–æ—Ç–∏–∫–∞", "–ë–∞—Ä–æ–∫–∫–æ", "–†–æ–º–∞–Ω—Å–∫–∏–π —Å—Ç–∏–ª—å", "–†–µ–Ω–µ—Å—Å–∞–Ω—Å"] },
          { value: 400, audio: "media/prokofiev.mp3", question: "–ü–æ—Å–ª—É—à–∞–π—Ç–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç. –ö–∞–∫–æ–π –∫–æ–º–ø–æ–∑–∏—Ç–æ—Ä –Ω–∞–ø–∏—Å–∞–ª —ç—Ç–æ—Ç –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–π '–¢–∞–Ω–µ—Ü —Ä—ã—Ü–∞—Ä–µ–π'?", correct: "–°–µ—Ä–≥–µ–π –ü—Ä–æ–∫–æ—Ñ—å–µ–≤", options: ["–ü—ë—Ç—Ä –ß–∞–π–∫–æ–≤—Å–∫–∏–π", "–î–º–∏—Ç—Ä–∏–π –®–æ—Å—Ç–∞–∫–æ–≤–∏—á", "–°–µ—Ä–≥–µ–π –ü—Ä–æ–∫–æ—Ñ—å–µ–≤", "–ò–≥–æ—Ä—å –°—Ç—Ä–∞–≤–∏–Ω—Å–∫–∏–π"] },
          { value: 600, question: "–ö–∞–∫–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –î–∞–Ω—Ç–µ –ê–ª–∏–≥—å–µ—Ä–∏ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–µ –ø–æ –∑–∞–≥—Ä–æ–±–Ω–æ–º—É –º–∏—Ä—É?", correct: "–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–º–µ–¥–∏—è", options: ["–î–µ–∫–∞–º–µ—Ä–æ–Ω", "–ë–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –∫–æ–º–µ–¥–∏—è", "–ü–µ—Å–Ω—å –æ –†–æ–ª–∞–Ω–¥–µ", "–ö–µ–Ω—Ç–µ—Ä–±–µ—Ä–∏–π—Å–∫–∏–µ —Ä–∞—Å—Å–∫–∞–∑—ã"] },
          { value: 800, question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–ª—Å—è –≤–æ–µ–Ω–Ω–æ-–º–æ–Ω–∞—à–µ—Å–∫–∏–π –æ—Ä–¥–µ–Ω, –æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–π –≤ –ü–∞–ª–µ—Å—Ç–∏–Ω–µ –¥–ª—è –∑–∞—â–∏—Ç—ã –ø–∞–ª–æ–º–Ω–∏–∫–æ–≤?", correct: "–¢–∞–º–ø–ª–∏–µ—Ä—ã", options: ["–§—Ä–∞–Ω—Ü–∏—Å–∫–∞–Ω—Ü—ã", "–¢–∞–º–ø–ª–∏–µ—Ä—ã", "–î–æ–º–∏–Ω–∏–∫–∞–Ω—Ü—ã", "–ì–æ—Å–ø–∏—Ç–∞–ª—å–µ—Ä—ã"] },
          { value: 1000, question: "–ö—Ç–æ –∏–∑–æ–±—Ä—ë–ª –∫–Ω–∏–≥–æ–ø–µ—á–∞—Ç–∞–Ω–∏–µ –≤ –ï–≤—Ä–æ–ø–µ –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ XV –≤–µ–∫–∞?", correct: "–ò–æ–≥–∞–Ω–Ω –ì—É—Ç–µ–Ω–±–µ—Ä–≥", options: ["–õ–µ–æ–Ω–∞—Ä–¥–æ –¥–∞ –í–∏–Ω—á–∏", "–ò–æ–≥–∞–Ω–Ω –ì—É—Ç–µ–Ω–±–µ—Ä–≥", "–ú–∞—Ä–∫–æ –ü–æ–ª–æ", "–†–æ–¥–∂–µ—Ä –ë—ç–∫–æ–Ω"] }
        ]
      },
      {
        id: "–≠–ø–æ—Ö–∞ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è",
        questions: [
          { value: 200, question: "–ö—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–æ–º –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–π –∫–∞—Ä—Ç–∏–Ω—ã '–ú–æ–Ω–∞ –õ–∏–∑–∞' (–î–∂–æ–∫–æ–Ω–¥–∞)?", correct: "–õ–µ–æ–Ω–∞—Ä–¥–æ –¥–∞ –í–∏–Ω—á–∏", options: ["–†–∞—Ñ–∞—ç–ª—å", "–ú–∏–∫–µ–ª–∞–Ω–¥–∂–µ–ª–æ", "–õ–µ–æ–Ω–∞—Ä–¥–æ –¥–∞ –í–∏–Ω—á–∏", "–ë–æ—Ç—Ç–∏—á–µ–ª–ª–∏"] },
          { value: 400, question: "–ö–∞–∫–æ–π –≥–æ—Ä–æ–¥ —Å—á–∏—Ç–∞–µ—Ç—Å—è –∫–æ–ª—ã–±–µ–ª—å—é –∏—Ç–∞–ª—å—è–Ω—Å–∫–æ–≥–æ –í–æ–∑—Ä–æ–∂–¥–µ–Ω–∏—è?", correct: "–§–ª–æ—Ä–µ–Ω—Ü–∏—è", options: ["–†–∏–º", "–§–ª–æ—Ä–µ–Ω—Ü–∏—è", "–í–µ–Ω–µ—Ü–∏—è", "–ú–∏–ª–∞–Ω"] },
          { value: 600, question: "–ö—Ç–æ –Ω–∞–ø–∏—Å–∞–ª –ø–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–π —Ç—Ä–∞–∫—Ç–∞—Ç '–ì–æ—Å—É–¥–∞—Ä—å', –≥–¥–µ —Ü–µ–ª—å –æ–ø—Ä–∞–≤–¥—ã–≤–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞?", correct: "–ù–∏–∫–∫–æ–ª–æ –ú–∞–∫–∏–∞–≤–µ–ª–ª–∏", options: ["–≠—Ä–∞–∑–º –†–æ—Ç—Ç–µ—Ä–¥–∞–º—Å–∫–∏–π", "–ù–∏–∫–∫–æ–ª–æ –ú–∞–∫–∏–∞–≤–µ–ª–ª–∏", "–¢–æ–º–∞—Å –ú–æ—Ä", "–ü–µ—Ç—Ä–∞—Ä–∫–∞"] },
          { value: 800, question: "–ö–∞–∫–æ–π —Ö—É–¥–æ–∂–Ω–∏–∫ –∏ —Å–∫—É–ª—å–ø—Ç–æ—Ä —Ä–∞—Å–ø–∏—Å–∞–ª –ø–æ—Ç–æ–ª–æ–∫ –°–∏–∫—Å—Ç–∏–Ω—Å–∫–æ–π –∫–∞–ø–µ–ª–ª—ã –≤ –í–∞—Ç–∏–∫–∞–Ω–µ?", correct: "–ú–∏–∫–µ–ª–∞–Ω–¥–∂–µ–ª–æ", options: ["–õ–µ–æ–Ω–∞—Ä–¥–æ –¥–∞ –í–∏–Ω—á–∏", "–ú–∏–∫–µ–ª–∞–Ω–¥–∂–µ–ª–æ", "–†–∞—Ñ–∞—ç–ª—å", "–¢–∏—Ü–∏–∞–Ω"] },
          { value: 1000, question: "–ö–∞–∫–æ–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –¥—Ä–∞–º–∞—Ç—É—Ä–≥ —è–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–æ–º —Ç—Ä–∞–≥–µ–¥–∏–π '–ì–∞–º–ª–µ—Ç' –∏ '–†–æ–º–µ–æ –∏ –î–∂—É–ª—å–µ—Ç—Ç–∞'?", correct: "–£–∏–ª—å—è–º –®–µ–∫—Å–ø–∏—Ä", options: ["–ö—Ä–∏—Å—Ç–æ—Ñ–µ—Ä –ú–∞—Ä–ª–æ", "–£–∏–ª—å—è–º –®–µ–∫—Å–ø–∏—Ä", "–ë–µ–Ω –î–∂–æ–Ω—Å–æ–Ω", "–î–∂–æ–Ω –ú–∏–ª—å—Ç–æ–Ω"] }
        ]
      },
      {
        id: "–ù–æ–≤–æ–µ –≤—Ä–µ–º—è",
        questions: [
          { value: 200, question: "–í –∫–∞–∫–æ–º –≤–µ–∫–µ –ø—Ä–æ–∏–∑–æ—à–ª–∞ –í–µ–ª–∏–∫–∞—è —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∞—è —Ä–µ–≤–æ–ª—é—Ü–∏—è?", correct: "XVIII –≤–µ–∫", options: ["XVII –≤–µ–∫", "XVIII –≤–µ–∫", "XIX –≤–µ–∫", "XVI –≤–µ–∫"] },
          { value: 400, question: "–ö—Ç–æ –Ω–∞–ø–∏—Å–∞–ª —Å–∏–º—Ñ–æ–Ω–∏—é ‚Ññ9 —Å –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–π '–û–¥–æ–π –∫ —Ä–∞–¥–æ—Å—Ç–∏'?", correct: "–õ—é–¥–≤–∏–≥ –≤–∞–Ω –ë–µ—Ç—Ö–æ–≤–µ–Ω", options: ["–ú–æ—Ü–∞—Ä—Ç", "–ë–∞—Ö", "–õ—é–¥–≤–∏–≥ –≤–∞–Ω –ë–µ—Ç—Ö–æ–≤–µ–Ω", "–®—É–±–µ—Ä—Ç"] },
          { value: 600, image: "https://media.discordapp.net/attachments/1344289233447419926/1427219339567829076/van_gogh.jpg?ex=68ee1117&is=68ecbf97&hm=07a2cf1c7025d30e0952a271960015c8efe9645599e61ad49d222066d75f386e&=&format=webp&width=1010&height=800", question: "–ö—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–æ–º —ç—Ç–æ–π –∫–∞—Ä—Ç–∏–Ω—ã –≤ —Å—Ç–∏–ª–µ –ø–æ—Å—Ç–∏–º–ø—Ä–µ—Å—Å–∏–æ–Ω–∏–∑–º–∞?", correct: "–í–∏–Ω—Å–µ–Ω—Ç –≤–∞–Ω –ì–æ–≥", options: ["–ö–ª–æ–¥ –ú–æ–Ω–µ", "–ü–æ–ª—å –ì–æ–≥–µ–Ω", "–í–∏–Ω—Å–µ–Ω—Ç –≤–∞–Ω –ì–æ–≥", "–ü–æ–ª—å –°–µ–∑–∞–Ω–Ω"] },
          { value: 800, question: "–ö—Ç–æ —Å–æ–∑–¥–∞–ª –∫–∞—Ä—Ç–∏–Ω—É '–°–≤–æ–±–æ–¥–∞, –≤–µ–¥—É—â–∞—è –Ω–∞—Ä–æ–¥', –ø–æ—Å–≤—è—â–µ–Ω–Ω—É—é –ò—é–ª—å—Å–∫–æ–π —Ä–µ–≤–æ–ª—é—Ü–∏–∏ 1830 –≥–æ–¥–∞?", correct: "–≠–∂–µ–Ω –î–µ–ª–∞–∫—Ä—É–∞", options: ["–§—Ä–∞–Ω—Å–∏—Å–∫–æ –ì–æ–π—è", "–≠–∂–µ–Ω –î–µ–ª–∞–∫—Ä—É–∞", "–ñ–∞–∫-–õ—É–∏ –î–∞–≤–∏–¥", "–¢–µ–æ–¥–æ—Ä –ñ–µ—Ä–∏–∫–æ"] },
          { value: 1000, question: "–ö–∞–∫–æ–π —Ñ–∏–ª–æ—Å–æ—Ñ, –∞–≤—Ç–æ—Ä '–ö—Ä–∏—Ç–∏–∫–∏ —á–∏—Å—Ç–æ–≥–æ —Ä–∞–∑—É–º–∞', —è–≤–ª—è–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ñ–∏–≥—É—Ä–æ–π –≤ –Ω–µ–º–µ—Ü–∫–æ–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏?", correct: "–ò–º–º–∞–Ω—É–∏–ª –ö–∞–Ω—Ç", options: ["–í–æ–ª—å—Ç–µ—Ä", "–ò–º–º–∞–Ω—É–∏–ª –ö–∞–Ω—Ç", "–ì–µ–≥–µ–ª—å", "–†—É—Å—Å–æ"] }
        ]
      },
      {
        id: "XX –≤–µ–∫ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å",
        questions: [
          { value: 200, question: "–ö—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–æ–º –∫–∞—Ä—Ç–∏–Ω—ã '–ß—ë—Ä–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç'?", correct: "–ö–∞–∑–∏–º–∏—Ä –ú–∞–ª–µ–≤–∏—á", options: ["–í–∞—Å–∏–ª–∏–π –ö–∞–Ω–¥–∏–Ω—Å–∫–∏–π", "–ö–∞–∑–∏–º–∏—Ä –ú–∞–ª–µ–≤–∏—á", "–ú–∞—Ä–∫ –®–∞–≥–∞–ª", "–ü–∞–±–ª–æ –ü–∏–∫–∞—Å—Å–æ"] },
          { value: 400, question: "–ö–∞–∫–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ –∏—Å–∫—É—Å—Å—Ç–≤–µ, –æ—Å–Ω–æ–≤–∞–Ω–Ω–æ–µ –ü–∞–±–ª–æ –ü–∏–∫–∞—Å—Å–æ –∏ –ñ–æ—Ä–∂–µ–º –ë—Ä–∞–∫–æ–º, –∏–∑–æ–±—Ä–∞–∂–∞–ª–æ –æ–±—ä–µ–∫—Ç—ã –≤ –≤–∏–¥–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º?", correct: "–ö—É–±–∏–∑–º", options: ["–ö—É–±–∏–∑–º", "–°—é—Ä—Ä–µ–∞–ª–∏–∑–º", "–§—É—Ç—É—Ä–∏–∑–º", "–≠–∫—Å–ø—Ä–µ—Å—Å–∏–æ–Ω–∏–∑–º"] },
          { value: 600, question: "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ñ–∏–ª–æ—Å–æ—Ñ—Å–∫–æ–µ —Ç–µ—á–µ–Ω–∏–µ, —Å—Ç–∞–≤—è—â–µ–µ –≤ —Ü–µ–Ω—Ç—Ä —Å–≤–æ–µ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –±—ã—Ç–∏—è —á–µ–ª–æ–≤–µ–∫–∞, –µ–≥–æ —Å–≤–æ–±–æ–¥—É –∏ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å?", correct: "–≠–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª–∏–∑–º", options: ["–ü–æ–∑–∏—Ç–∏–≤–∏–∑–º", "–≠–∫–∑–∏—Å—Ç–µ–Ω—Ü–∏–∞–ª–∏–∑–º", "–ü—Ä–∞–≥–º–∞—Ç–∏–∑–º", "–°—Ç—Ä—É–∫—Ç—É—Ä–∞–ª–∏–∑–º"] },
          { value: 800, question: "–ö–∞–∫–æ–π –∏—Å–ø–∞–Ω—Å–∫–∏–π —Ö—É–¥–æ–∂–Ω–∏–∫-—Å—é—Ä—Ä–µ–∞–ª–∏—Å—Ç –∏–∑–≤–µ—Å—Ç–µ–Ω —Å–≤–æ–∏–º–∏ —Ä–∞–±–æ—Ç–∞–º–∏ '–ü–æ—Å—Ç–æ—è–Ω—Å—Ç–≤–æ –ø–∞–º—è—Ç–∏' (—Å –ø–ª–∞–≤—è—â–∏–º–∏—Å—è —á–∞—Å–∞–º–∏)?", correct: "–°–∞–ª—å–≤–∞–¥–æ—Ä –î–∞–ª–∏", options: ["–•–æ–∞–Ω –ú–∏—Ä–æ", "–ü–∞–±–ª–æ –ü–∏–∫–∞—Å—Å–æ", "–°–∞–ª—å–≤–∞–¥–æ—Ä –î–∞–ª–∏", "–†–µ–Ω–µ –ú–∞–≥—Ä–∏—Ç—Ç"] },
          { value: 1000, question: "–ö–∞–∫–æ–µ –∫—É–ª—å—Ç—É—Ä–Ω–æ–µ —è–≤–ª–µ–Ω–∏–µ, –æ—Ç—Ä–∏—Ü–∞—é—â–µ–µ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–µ –∫–∞–Ω–æ–Ω—ã –∏ –∏—â—É—â–µ–µ –Ω–æ–≤—ã–µ —Ñ–æ—Ä–º—ã, –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤ —Å–µ–±–µ –º–æ–¥–µ—Ä–Ω–∏–∑–º, –∞–≤–∞–Ω–≥–∞—Ä–¥ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—á–µ–Ω–∏—è?", correct: "–ü–æ—Å—Ç–º–æ–¥–µ—Ä–Ω–∏–∑–º", options: ["–°–æ—Ü—Ä–µ–∞–ª–∏–∑–º", "–ü–æ—Å—Ç–º–æ–¥–µ—Ä–Ω–∏–∑–º", "–ú–µ—Ç–∞–º–æ–¥–µ—Ä–Ω–∏–∑–º", "–ù–µ–æ–∫–ª–∞—Å—Å–∏—Ü–∏–∑–º"] }
        ]
      }
    ];
    const teamAInput = document.getElementById("teamA");
    const teamBInput = document.getElementById("teamB");
    const confirmBtn = document.getElementById("confirmBtn");
    const playBtn = document.getElementById("playBtn");
    const hint = document.querySelector(".hint");
    const coinModal = document.getElementById("coinModal");
    const coin = document.getElementById("coin");
    const coinResult = document.getElementById("coinResult");
    const coinOk = document.getElementById("coinOk");
    const timerDisplay = document.getElementById('timer-display');
    const STORAGE_KEY = 'svoyaIgraState_culture_v5_local';
    let timerInterval = null;
    let totalQuestions = categories.reduce((acc, cat) => acc + cat.questions.length, 0);
    let gameState = {
        settings: { lifelinesCount: 3, answerTime: 30, penaltyMode: 'none' },
        team1: { name: '', score: 0, lifelines: 3 },
        team2: { name: '', score: 0, lifelines: 3 },
        currentTurn: null,
        currentQuestion: null,
        answeredQuestions: {},
        gameStarted: false,
    };
    function saveGameState() {
      try { localStorage.setItem(STORAGE_KEY, JSON.stringify(gameState)); } 
      catch (e) { console.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã:", e); }
    }
    function loadGameState() {
      try {
        const savedState = localStorage.getItem(STORAGE_KEY);
        if (savedState) {
          gameState = JSON.parse(savedState);
          if (gameState.gameStarted) {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('game-screen').classList.remove('hidden');
            updateScoreboard();
            updateTurnText();
            buildBoard();
          } else {
             teamAInput.value = gameState.team1.name;
             teamBInput.value = gameState.team2.name;
             if (teamAInput.value && teamBInput.value) {
                confirmBtn.click();
             }
          }
        }
      } catch (e) { console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã:", e); localStorage.removeItem(STORAGE_KEY); }
    }
    confirmBtn.addEventListener("click", () => {
      playClick();
      const teamA = teamAInput.value.trim();
      const teamB = teamBInput.value.trim();
      if (!teamA || !teamB) {
        hint.textContent = "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è –æ–±–µ–∏—Ö –∫–æ–º–∞–Ω–¥";
        hint.style.color = "#ff6b6b";
        playError();
        return;
      }
      playSuccess();
      gameState.team1.name = teamA;
      gameState.team2.name = teamB;
      hint.style.color = "#4a9eff";
      hint.textContent = `–ö–æ–º–∞–Ω–¥—ã –≥–æ—Ç–æ–≤—ã: "${teamA}" –ø—Ä–æ—Ç–∏–≤ "${teamB}"`;
      confirmBtn.classList.add("hidden");
      playBtn.classList.remove("hidden");
      teamAInput.disabled = true;
      teamBInput.disabled = true;
      saveGameState();
    });
    playBtn.addEventListener("click", () => {
      playClick();
      coinModal.classList.remove("hidden");
      coinResult.textContent = "";
      coinOk.classList.add("hidden");
      coin.style.transform = 'rotateY(0deg)';
      setTimeout(() => {
        const isHeads = Math.random() > 0.5;
        const rotations = 6 + Math.floor(Math.random() * 2);
        const rotation = (rotations * 360) + (isHeads ? 0 : 180);
        coin.style.transform = `rotateY(${rotation}deg)`;
        playSound(440, 2.5, 'sawtooth');
        setTimeout(() => {
          playSuccess();
          gameState.currentTurn = isHeads ? 'team1' : 'team2';
          const winnerName = isHeads ? gameState.team1.name : gameState.team2.name;
          coinResult.textContent = isHeads 
            ? `–í—ã–ø–∞–ª –û–†–ï–õ ‚Äî –Ω–∞—á–∏–Ω–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ "${winnerName}"` 
            : `–í—ã–ø–∞–ª–∞ –†–ï–®–ö–ê ‚Äî –Ω–∞—á–∏–Ω–∞–µ—Ç –∫–æ–º–∞–Ω–¥–∞ "${winnerName}"`;
          coinOk.classList.remove("hidden");
          saveGameState();
        }, 2600);
      }, 400);
    });
    coinOk.addEventListener("click", () => {
      playClick();
      coinModal.classList.add("hidden");
      const overlay = document.createElement("div");
      overlay.style.cssText = "position:fixed;inset:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:9999;font-size:10rem;color:var(--primary-glow);font-weight:900;";
      document.body.appendChild(overlay);
      let num = 3;
      const countdown = () => {
        if (num > 0) {
          overlay.textContent = num;
          playClick();
          num--;
          setTimeout(countdown, 1000);
        } else {
          overlay.textContent = "–°–¢–ê–†–¢!";
          playSuccess();
          setTimeout(() => {
            overlay.remove();
            startGame();
          }, 800);
        }
      };
      countdown();
    });
    function showSettings() {
      playClick();
      document.getElementById('lifelines-count').value = gameState.settings.lifelinesCount === Infinity ? 'unlimited' : gameState.settings.lifelinesCount;
      document.getElementById('answer-time').value = gameState.settings.answerTime;
      document.getElementById('penalty-mode').value = gameState.settings.penaltyMode;
      document.getElementById('settingsModal').classList.remove('hidden');
    }
    function closeSettings() { playClick(); document.getElementById('settingsModal').classList.add('hidden'); }
    function saveSettings() {
      playClick();
      const lifelinesCount = document.getElementById('lifelines-count').value;
      gameState.settings.lifelinesCount = lifelinesCount === 'unlimited' ? Infinity : parseInt(lifelinesCount);
      gameState.settings.answerTime = document.getElementById('answer-time').value;
      gameState.settings.penaltyMode = document.getElementById('penalty-mode').value;
      if (!gameState.gameStarted) {
        gameState.team1.lifelines = gameState.settings.lifelinesCount;
        gameState.team2.lifelines = gameState.settings.lifelinesCount;
      }
      updateScoreboard();
      closeSettings();
      saveGameState();
      playSuccess();
    }
    function startGame() {
      gameState.gameStarted = true;
      gameState.team1.lifelines = gameState.settings.lifelinesCount;
      gameState.team2.lifelines = gameState.settings.lifelinesCount;
      document.getElementById('start-screen').classList.add('hidden');
      document.getElementById('game-screen').classList.remove('hidden');
      updateScoreboard();
      updateTurnText();
      buildBoard();
      saveGameState();
    }
    function updateTurnText() {
        const currentTeamName = gameState.currentTurn === 'team1' ? gameState.team1.name : gameState.team2.name;
        document.getElementById("turn-indicator").textContent = "–°–µ–π—á–∞—Å —Ö–æ–¥–∏—Ç: " + currentTeamName;
    }
    function updateScoreboard() {
        document.getElementById("team1-name").textContent = gameState.team1.name;
        document.getElementById("team1-score").textContent = gameState.team1.score;
        document.getElementById("team1-lifelines").textContent = gameState.team1.lifelines === Infinity ? '‚àû' : gameState.team1.lifelines;
        document.getElementById("team2-name").textContent = gameState.team2.name;
        document.getElementById("team2-score").textContent = gameState.team2.score;
        document.getElementById("team2-lifelines").textContent = gameState.team2.lifelines === Infinity ? '‚àû' : gameState.team2.lifelines;
    }
    function adjustScore(teamId, amount) {
        playClick();
        gameState[teamId].score += amount;
        if (gameState[teamId].score < 0) {
            gameState[teamId].score = 0;
        }
        updateScoreboard();
        saveGameState();
    }
    function buildBoard() {
      const board = document.getElementById('board');
      board.innerHTML = "";
      categories.forEach(cat => {
        const row = document.createElement("div");
        row.style.cssText = "display:grid;grid-template-columns:1.5fr repeat(5,1fr);gap:8px;align-items:center;";
        const title = document.createElement("div");
        title.className = "category-title";
        title.textContent = cat.id;
        row.appendChild(title);
        cat.questions.forEach(q => {
          const btn = document.createElement("div");
          btn.className = "value-btn";
          btn.textContent = q.value;
          const key = cat.id + q.value;
          btn.dataset.key = key;
          if(gameState.answeredQuestions[key]) {
             btn.classList.add('used');
          } else {
             btn.onclick = () => onValueClick(key, q);
          }
          row.appendChild(btn);
        });
        board.appendChild(row);
      });
    }

    // --- –ò–ó–ú–ï–ù–ï–ù–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø ---
    function onValueClick(key, questionData) {
      playClick();
      gameState.currentQuestion = { key, ...questionData };
      const mediaContainer = document.getElementById('media-container');
      mediaContainer.innerHTML = ''; // –û—á–∏—â–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

      // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–æ—Å—Ç–∞–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
      if (questionData.image) {
          const img = document.createElement('img');
          img.src = questionData.image;
          mediaContainer.appendChild(img);
      }

      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —É –≤–æ–ø—Ä–æ—Å–∞ –∞—É–¥–∏–æ
      if (questionData.audio) {
          console.log("–í–æ–ø—Ä–æ—Å —Å–æ–¥–µ—Ä–∂–∏—Ç –∞—É–¥–∏–æ:", questionData.audio); // –î–æ–±–∞–≤–∏–º –ª–æ–≥ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

          const audio = document.createElement('audio');
          audio.controls = true; // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–ª–µ–µ—Ä–æ–º
          audio.src = questionData.audio; // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—É—Ç—å –∏–∑ –¥–∞–Ω–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–∞

          // –î–æ–±–∞–≤–∏–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫, —á—Ç–æ–±—ã —Ç–æ—á–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –Ω–µ —Ç–∞–∫
          audio.addEventListener('error', function(e) {
              console.error("–û–®–ò–ë–ö–ê –ó–ê–ì–†–£–ó–ö–ò –ê–£–î–ò–û!");
              console.error("–ë—Ä–∞—É–∑–µ—Ä –Ω–µ —Å–º–æ–≥ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª –ø–æ –ø—É—Ç–∏:", audio.src);
              console.error("–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –∑–∞–ø—É—Å–∫–∞–µ—Ç–µ –ø—Ä–æ–µ–∫—Ç —á–µ—Ä–µ–∑ Live Server (–Ω–µ –¥–≤–æ–π–Ω—ã–º –∫–ª–∏–∫–æ–º –ø–æ —Ñ–∞–π–ª—É). –í –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 'file:///'.");
              console.error("–¢–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–∞–ø–∫–∞ 'media' –∏ —Ñ–∞–π–ª 'prokofiev.mp3' —Å—É—â–µ—Å—Ç–≤—É—é—Ç –∏ –Ω–∞–ø–∏—Å–∞–Ω—ã –±–µ–∑ –æ—à–∏–±–æ–∫.");
          });
          
          audio.autoplay = true; // –ü–æ–ø—Ä–æ–±—É–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
          mediaContainer.appendChild(audio);
      }

      document.getElementById('question').textContent = questionData.question;
      const optionsEl = document.getElementById('options');
      optionsEl.innerHTML = "";
      const shuffledOptions = shuffleArray(questionData.options);
      shuffledOptions.forEach(opt => {
        const btn = document.createElement("button");
        btn.className = "option-btn";
        btn.textContent = opt;
        btn.onclick = () => checkAnswer(opt);
        optionsEl.appendChild(btn);
      });
      document.getElementById('score').textContent = "";
      const currentTeamLifelines = gameState.currentTurn === 'team1' ? gameState.team1.lifelines : gameState.team2.lifelines;
      const fiftyBtn = document.getElementById('fifty-fifty-btn');
      fiftyBtn.style.display = currentTeamLifelines > 0 ? 'inline-block' : 'none';
      fiftyBtn.disabled = false;
      document.getElementById('question-box').style.display = "flex";
      startTimer();
    }
    // --- –ö–û–ù–ï–¶ –ò–ó–ú–ï–ù–ï–ù–ù–û–ô –§–£–ù–ö–¶–ò–ò ---

    function startTimer() {
        clearInterval(timerInterval);
        timerDisplay.classList.remove('low-time');
        if (gameState.settings.answerTime === 'unlimited') {
            timerDisplay.textContent = '‚àû';
            return;
        }
        let timeLeft = parseInt(gameState.settings.answerTime);
        timerDisplay.textContent = timeLeft;
        timerInterval = setInterval(() => {
            timeLeft--;
            timerDisplay.textContent = timeLeft;
            if (timeLeft <= 5 && timeLeft > 0) {
                timerDisplay.classList.add('low-time');
                playSound(800, 0.1, 'square');
            }
            if (timeLeft <= 0) {
                clearInterval(timerInterval);
                playError();
                checkAnswer(null, true);
            }
        }, 1000);
    }
    document.getElementById('fifty-fifty-btn').addEventListener('click', () => {
      playClick();
      const currentTeam = gameState[gameState.currentTurn];
      if (currentTeam.lifelines <= 0) return;
      if (currentTeam.lifelines !== Infinity) currentTeam.lifelines--;
      updateScoreboard();
      const correct = gameState.currentQuestion.correct;
      const allOptions = Array.from(document.getElementById('options').children);
      const incorrectOptions = allOptions.filter(btn => btn.textContent !== correct);
      shuffleArray(incorrectOptions).slice(0, 2).forEach(btn => btn.classList.add('fifty-fifty-hidden'));
      document.getElementById('fifty-fifty-btn').disabled = true;
      saveGameState();
      playSuccess();
    });
    function checkAnswer(selected, isTimeout = false) {
      clearInterval(timerInterval);
      const { correct, value, key } = gameState.currentQuestion;
      const optionsEl = document.getElementById('options');
      Array.from(optionsEl.children).forEach(btn => {
        btn.disabled = true;
        if (btn.textContent === correct) btn.style.background = 'rgba(0, 180, 0, 0.6)';
        else if (btn.textContent === selected) btn.style.background = 'rgba(180, 0, 0, 0.6)';
      });
      let penalty = 0;
      if (selected === correct) {
        playSuccess();
        document.getElementById('score').textContent = `‚úÖ –í–µ—Ä–Ω–æ! +${value}`;
        gameState[gameState.currentTurn].score += value;
      } else {
        playError();
        let resultText = isTimeout ? `‚è∞ –í—Ä–µ–º—è –≤—ã—à–ª–æ!` : `‚ùå –ù–µ–≤–µ—Ä–Ω–æ!`;
        if (gameState.settings.penaltyMode === 'half') penalty = Math.floor(value / 2);
        else if (gameState.settings.penaltyMode === 'full') penalty = value;
        if (penalty > 0) {
          resultText += ` –®—Ç—Ä–∞—Ñ: -${penalty}`;
          const team = gameState[gameState.currentTurn];
          team.score = Math.max(0, team.score - penalty);
        }
        document.getElementById('score').textContent = resultText;
      }
      updateScoreboard();
      gameState.answeredQuestions[key] = true;
      document.querySelector(`[data-key='${key}']`).classList.add('used');
      setTimeout(() => {
        document.getElementById('question-box').style.display = "none";
        document.getElementById('media-container').innerHTML = '';
        if (Object.keys(gameState.answeredQuestions).length >= totalQuestions) {
          showWinner();
        } else {
          gameState.currentTurn = gameState.currentTurn === 'team1' ? 'team2' : 'team1';
          updateTurnText();
        }
        saveGameState();
      }, 3000);
    }
    function showWinner() {
      let winnerText;
      if (gameState.team1.score > gameState.team2.score) {
        winnerText = `üèÜ –ü–æ–±–µ–¥–∏–ª–∞ –∫–æ–º–∞–Ω–¥–∞ "${gameState.team1.name}"!`;
      } else if (gameState.team2.score > gameState.team1.score) {
        winnerText = `üèÜ –ü–æ–±–µ–¥–∏–ª–∞ –∫–æ–º–∞–Ω–¥–∞ "${gameState.team2.name}"!`;
      } else {
        winnerText = "ü§ù –ù–∏—á—å—è!";
      }
      const finalResult = document.getElementById('final-result');
      finalResult.innerHTML = `${winnerText}<br><br>–ò—Ç–æ–≥–æ–≤—ã–π —Å—á—ë—Ç: ${gameState.team1.score} : ${gameState.team2.score}<br><br><button class="small-btn" onclick="resetGame()">–ù–æ–≤–∞—è –∏–≥—Ä–∞</button>`;
      finalResult.style.display = "flex";
      triggerConfetti();
      playSuccess();
    }
    function resetGame() {
      playClick();
      try { localStorage.removeItem(STORAGE_KEY); } 
      catch (e) { console.error("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã:", e); }
      location.reload();
    }
    window.addEventListener('DOMContentLoaded', loadGameState);
  </script>
</body>
</html>